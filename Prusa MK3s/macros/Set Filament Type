if sensors.filamentMonitors[0].filamentPresent = false  

  M291 P"Press OK to change filament type, else press CANCEL to exit." R"Filament Handling" S3

  ; Set PLA temp
  M28 "0:/macros/Heat Nozzle"
  M291 R"Filament Handling" P"Heating nozzle for PLA, please wait." S0 T5
  T0 ; Activate Hotend
  M104 S200                           ; set nozzle temp to 200c
  M109 S200                           ; wait for extruder temp
  M29
  
  M28 "0:/sys/filaset"
  ; This gcode is used by Filament Handling Macro
  T0 M702
  T0 M701 S"PLA"
  M29  

  M291 S3 R"Filament Handling" P"Filament type currently set to PLA. Press cancel to save this selection or OK to proceed to next filament type."
  
  ; Set PETg temp
  M28 "0:/macros/Heat Nozzle"
  M291 R"Filament Handling" P"Heating nozzle for PETg, please wait." S0 T5
  T0 ; Activate Hotend
  M104 S230                           ; set nozzle temp to 230c
  M109 S230                           ; wait for extruder temp
  M29
  
  M28 "0:/sys/filaset"
  ; This gcode is used by Filament Handling Macro
  T0 M702
  T0 M701 S"PETG"
  M29  

  M291 S3 R"Filament Handling" P"Filament type currently set to PETg. Press cancel to save this selection or OK to proceed to next filament type."

  ; Set ABS temp
  M28 "0:/macros/Heat Nozzle"
  M291 R"Filament Handling" P"Heating nozzle for ABS, please wait." S0 T5
  T0 ; Activate Hotend
  M104 S250                           ; set nozzle temp to 250c
  M109 S250                           ; wait for extruder temp
  M29
  
  M28 "0:/sys/filaset"
  ; This gcode is used by Filament Handling Macro
  T0 M702
  T0 M701 S"ABS"
  M29  

  M291 S3 R"Filament Handling" P"Filament type currently set to ABS. Press cancel to save this selection or OK to proceed to next filament type."

  ; Set PC temp
  M28 "0:/macros/Heat Nozzle"
  M291 R"Filament Handling" P"Heating nozzle for PC, please wait." S0 T5
  T0 ; Activate Hotend
  M104 S270                           ; set nozzle temp to 270c
  M109 S270                           ; wait for extruder temp
  M29
  
  M28 "0:/sys/filaset"
  ; This gcode is used by Filament Handling Macro
  T0 M702
  T0 M701 S"ABS"
  M29  

  M291 S3 R"Filament Handling" P"Filament type currently set to PC. Press cancel to save this selection or OK to proceed to next filament type."

else

 M291 S3 R"Filament Handling" P"Filament is currently loaded. Please unload filament before changing filament type."

